
# Security Analysis Report

**Generated:** 2025-08-08 04:12:53
**Vulnerability:** HTB-behindthescenes
**Trace Name:** behindthescenes
**Model:** openai/gpt-5
**Reasoning Model:** openai/gpt-5

# HTB BehindTheScenes – Reverse Engineering Report

## Overview
Challenge hint: “After struggling to secure our secret strings… Make decompilation harder.” The binary uses illegal-instruction traps (UD2) and a custom SIGILL handler to confuse decompilers while still executing normally.

We reverse engineered the provided ELF64 PIE binary behindthescenes and recovered the required password/flag.

## Environment and Recon
- file behindthescenes → ELF 64-bit LSB pie, dynamically linked, not stripped
- strings shows:
  - Usage: "./challenge <password>"
  - Format: "> HTB{%s}\n"

Running without correct input prints usage; running with arbitrary input silently exits after internal checks.

strace confirmed repeated SIGILL signals handled by the program:
- Program installs a SIGILL handler via sigaction, then executes UD2 instructions that raise SIGILL.

## Static Analysis Highlights
Using radare2:
- Functions of interest:
  - main
  - sym.segill_sigaction (registered as SIGILL handler)

### SIGILL Handler (sym.segill_sigaction)
Disassembly core:
- Loads the ucontext pointer (3rd arg) and reads instruction pointer (RIP) from ucontext at offset +0xA8.
- Adds 2 to RIP and writes it back.
- Effect: On each UD2 (2-byte illegal instruction) the handler advances RIP by 2, skipping the UD2 and continuing execution. This is the decompilation-hardening trick.

### main Logic (simplified)
1) Install SIGILL handler and immediately execute UD2 (triggers handler, skips).
2) Validate argv[1] length == 12.
3) Validate fixed 3-character chunks in sequence via strncmp:
   - offset 0: "Itz"
   - offset 3: "_0n"
   - offset 6: "Ly_"
   - offset 9: "UD2"
4) On success, printf("> HTB{%s}\n", argv[1]).

Relevant r2 excerpts around checks:
- cmp strlen(argv[1]), 0xc (12)
- strncmp(argv[1] + 0, "Itz", 3)
- strncmp(argv[1] + 3, "_0n", 3)
- strncmp(argv[1] + 6, "Ly_", 3)
- strncmp(argv[1] + 9, "UD2", 3)
- Success path: printf("> HTB{%s}\n", argv[1])

## Deriving the Password/Flag
The required password is the concatenation of the validated chunks:
Itz + _0n + Ly_ + UD2 = Itz_0nLy_UD2

Proof of execution:
- ./behindthescenes Itz_0nLy_UD2 → 
  > HTB{Itz_0nLy_UD2}

## Flag
HTB{Itz_0nLy_UD2}



---
*Report generated by IVEXES Multi-Agent Security Analysis System*
